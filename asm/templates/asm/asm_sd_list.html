{% extends "dashboards/base_asm.html" %}
{% block content %}
<script src="https://unpkg.com/lucide@latest"></script>

<style>
/* Smooth fade animation */
.fade-in {
  animation: fadeIn 0.4s ease-in-out;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(5px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Card hover */
.table-row:hover {
  background: #f0f6ff !important;
}

/* Mobile card tap effect */
.card-tap {
  transition: transform 0.15s ease, box-shadow 0.15s ease;
}
.card-tap:active {
  transform: scale(0.98);
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}
</style>

<div class="p-4 fade-in">
  <div class="flex justify-between items-center mb-4">
    <h1 class="text-2xl font-bold text-blue-700">SD Collections</h1>

    <a href="{% url 'asm_sd_add' %}"
       class="bg-blue-600 hover:bg-blue-700 transition text-white px-4 py-2 rounded-xl shadow">
       + Add Collection
    </a>
  </div>

  <!-- Filters -->
  <div class="bg-white p-4 rounded-xl shadow mb-4">
    <form method="get" class="grid grid-cols-1 sm:grid-cols-4 gap-2">
      <input type="date" name="start_date" value="{{ start_date }}" class="border p-2 rounded-lg">

      <input type="date" name="end_date" value="{{ end_date }}" class="border p-2 rounded-lg">

      <select name="status" class="border p-2 rounded-lg">
        <option value="">All</option>
        <option value="pending" {% if status == 'pending' %}selected{% endif %}>Pending</option>
        <option value="completed" {% if status == 'completed' %}selected{% endif %}>Completed</option>
        <option value="cancelled" {% if status == 'cancelled' %}selected{% endif %}>Cancelled</option>
      </select>

      <button class="bg-blue-600 hover:bg-blue-700 transition text-white px-3 py-2 rounded-lg shadow">
        Apply
      </button>
    </form>
  </div>

  <!-- Desktop Table -->
  <div class="hidden sm:block bg-white rounded-xl shadow overflow-x-auto">
    <table class="min-w-full">
      <thead class="bg-blue-50">
        <tr class="text-left">
          <th class="p-3 font-semibold text-gray-700">Partner</th>
          <th class="p-3 font-semibold text-gray-700">Amount</th>
          <th class="p-3 font-semibold text-gray-700">Date</th>
          <th class="p-3 font-semibold text-gray-700">Status</th>
          <th class="p-3 font-semibold text-gray-700">Actions</th>
        </tr>
      </thead>

      <tbody>
        {% for c in collections %}
        <tr class="border-t table-row transition">
          <td class="p-3">{{ c.partner.get_full_name }}</td>
          <td class="p-3 font-semibold text-blue-700">₹{{ c.amount }}</td>
          <td class="p-3">{{ c.date }}</td>
          <td class="p-3">
            <span class="px-2 py-1 rounded-lg 
              {% if c.status == 'pending' %}bg-yellow-100 text-yellow-700
              {% elif c.status == 'completed' %}bg-green-100 text-green-700
              {% else %}bg-red-100 text-red-700{% endif %}">
              {{ c.status|title }}
            </span>
          </td>
          <td class="p-3">
            <a href="{% url 'asm_sd_edit' c.id %}"
               class="text-blue-600 hover:text-blue-800 font-medium mr-3">Edit</a>

            <a href="{% url 'asm_sd_delete' c.id %}"
               class="text-red-600 hover:text-red-800 font-medium">Delete</a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5" class="p-4 text-center text-gray-500">No collections found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Mobile Cards -->
  <div class="sm:hidden grid gap-3">
    {% for c in collections %}
    <div class="bg-white p-4 rounded-xl shadow card-tap">
      <div class="flex justify-between">
        <div>
          <div class="font-semibold text-gray-800">{{ c.partner.get_full_name }}</div>
          <div class="text-sm text-gray-500">{{ c.date }}</div>
        </div>

        <div class="text-right">
          <div class="font-semibold text-blue-700 text-lg">₹{{ c.amount }}</div>
          <div class="text-xs text-gray-500">{{ c.status|title }}</div>
        </div>
      </div>

      <div class="mt-3 flex gap-4 text-sm">
        <a href="{% url 'asm_sd_edit' c.id %}" class="text-blue-600 font-medium">Edit</a>
        <a href="{% url 'asm_sd_delete' c.id %}" class="text-red-600 font-medium">Delete</a>
      </div>
    </div>
    {% endfor %}
  </div>

</div>

{% endblock %}
