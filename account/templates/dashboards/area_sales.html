{% extends 'dashboards/base_asm.html' %}
{% block title %}ASM Dashboard | Skyplay{% endblock %}

{% block content %}
<div class="text-center mb-6 animate-fade">
  <h2 class="text-3xl font-extrabold text-blue-700">{{ asm_profile.full_name }}</h2>
  <p class="text-gray-500 mt-1">Your Performance Overview</p>
</div>

<!-- KPIs -->
<div class="grid grid-cols-2 md:grid-cols-4 gap-4">
  
  <!-- Performance -->
  <div class="rounded-xl p-4 shadow bg-gradient-to-r from-blue-600 to-blue-800 text-white animate-slide-up">
    <p class="text-xs opacity-80">Performance</p>
    <h2 class="text-3xl font-bold">{{ asm_performance }}%</h2>
  </div>

  <!-- Applications -->
  <div class="rounded-xl p-4 shadow bg-gradient-to-r from-blue-400 to-blue-500 text-white animate-slide-up">
    <p class="text-xs opacity-80">Applications</p>
    <h2 class="text-2xl font-bold">{{ total_application_achieve }}/{{ total_application_target }}</h2>
  </div>

  <!-- POP -->
  <div class="rounded-xl p-4 shadow bg-gradient-to-r from-blue-500 to-blue-600 text-white animate-slide-up">
    <p class="text-xs opacity-80">POP</p>
    <h2 class="text-2xl font-bold">{{ total_pop_achieve }}/{{ total_pop_target }}</h2>
  </div>

  <!-- Revenue -->
  <div class="rounded-xl p-4 shadow bg-gradient-to-r from-blue-700 to-blue-900 text-white animate-slide-up">
    <p class="text-xs opacity-80">Revenue (L)</p>
    <h2 class="text-2xl font-bold">â‚¹{{ total_revenue }}</h2>
  </div>
</div>

<!-- Charts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-6">

  <!-- Performance Trend -->
  <div class="bg-white rounded-xl p-5 shadow border border-gray-100">
    <h3 class="font-semibold mb-3 text-blue-700">Performance Trend</h3>
    <canvas id="performanceChart"></canvas>
  </div>

  <!-- Revenue Trend -->
  <div class="bg-white rounded-xl p-5 shadow border border-gray-100">
    <h3 class="font-semibold mb-3 text-blue-700">Revenue Trend (Lakhs)</h3>
    <canvas id="revenueChart"></canvas>
  </div>

</div>

<script>
const months = {{ chart_months|safe }};
const perf = {{ chart_performance|safe }};
const revenue = {{ chart_revenue|safe }};

new Chart(document.getElementById("performanceChart"), {
  type: "line",
  data: {
    labels: months,
    datasets: [{
      label: "Performance %",
      data: perf,
      borderColor: "#1e40af",
      backgroundColor: "rgba(30,64,175,0.2)",
      fill: true,
      tension: 0.4
    }]
  },
  options: { responsive:true, plugins:{ legend:{ display:false }} }
});

new Chart(document.getElementById("revenueChart"), {
  type: "bar",
  data: {
    labels: months,
    datasets: [{
      label: "Revenue (L)",
      data: revenue,
      backgroundColor: "#1d4ed8",
      borderRadius: 6
    }]
  },
  options: { responsive:true, plugins:{ legend:{ display:false }} }
});
</script>

<style>
@keyframes fade { from {opacity:0;} to {opacity:1;} }
.animate-fade { animation: fade 0.6s ease; }

@keyframes slide-up { from {transform:translateY(10px);opacity:0;} to {transform:translateY(0);opacity:1;} }
.animate-slide-up { animation: slide-up 0.6s ease; }
</style>

{% endblock %}
